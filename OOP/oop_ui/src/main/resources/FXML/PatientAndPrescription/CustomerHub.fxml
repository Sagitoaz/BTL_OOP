<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.ProgressIndicator?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<?import javafx.scene.control.ListView?>
<BorderPane prefHeight="800.0" prefWidth="1280.0" stylesheets="@../../css/employee-pink-theme.css,@../../css/main.css,@../../css/forms.css,@../../css/buttons.css,@../../css/layouts.css,@../../css/financial-report.css,@../../css/navigation.css,@../../css/global-styles.css,@../../css/tables.css" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.oop.Control.PatientAndPrescription.CustomerHubController">

    <top>
        <!-- Navigation Bar -->
        <HBox alignment="CENTER_LEFT" spacing="8" style="-fx-padding: 12px 20px;" styleClass="navigation-bar" xmlns:fx="http://javafx.com/fxml/1">
            <Button fx:id="backButton" onAction="#handleBackButton" styleClass="nav-button nav-back-button" text="â—€ Quay láº¡i" />
            <Button fx:id="forwardButton" onAction="#handleForwardButton" styleClass="nav-button nav-forward-button" text="Tiáº¿n â–¶" />
            <Button fx:id="reloadButton" onAction="#handleReloadButton" styleClass="nav-button nav-reload-button" text="âŸ³ Táº£i láº¡i" />
            
            <!-- Loading Status Indicator -->
            <HBox fx:id="loadingStatusContainer" alignment="CENTER_LEFT" spacing="8" style="-fx-padding: 5px 15px; -fx-background-color: rgba(14,165,233,0.1); -fx-background-radius: 8px; -fx-border-color: #0EA5E9; -fx-border-width: 1px; -fx-border-radius: 8px;" visible="false">
                <ProgressIndicator fx:id="statusProgressIndicator" prefHeight="20.0" prefWidth="20.0" style="-fx-progress-color: #0EA5E9;" />
                <Label fx:id="loadingStatusLabel" style="-fx-text-fill: #0EA5E9; -fx-font-weight: 600; -fx-font-size: 13px;" text="â³ Äang táº£i dá»¯ liá»‡u..." />
            </HBox>
        </HBox>
    </top>
    
    <center>
        <SplitPane dividerPositions="0.4" styleClass="main-container">

    <!-- LEFT PANEL: Customer List & Filters -->
    <items>
        <VBox spacing="16.0">
            <padding>
                <Insets bottom="16.0" left="16.0" right="16.0" top="16.0" />
            </padding>

            <TitledPane expanded="true" styleClass="titled-pane blue-gradient" text="ðŸ‘¥ Bá»†NH NHÃ‚N">
                <VBox spacing="12">
                    <padding>
                        <Insets bottom="12" left="12" right="12" top="12" />
                    </padding>

                    <Button fx:id="addCustomerButton" maxWidth="Infinity" onAction="#onAddCustomerButton" styleClass="btn-success" text="âž• ThÃªm Má»›i" />
                    <Button fx:id="exportButton" maxWidth="Infinity" onAction="#onExportButton" styleClass="export-button" text="ðŸ“Š Export" />

                    <TextField fx:id="searchField" promptText="TÃ¬m kiáº¿m theo tÃªn hoáº·c ID..." styleClass="text-field" />

                    <Separator />

                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <Label styleClass="form-label" text="Lá»c theo:" />
                        <ComboBox fx:id="genderFilter" promptText="Giá»›i tÃ­nh" style="-fx-text-fill: #2C3E50;" styleClass="combo-rounded" HBox.hgrow="ALWAYS" />
                    </HBox>

                    <VBox spacing="6">
                        <Label styleClass="form-label" text="Khoáº£ng ngÃ y sinh:" />
                        <HBox spacing="8.0">
                            <DatePicker fx:id="dobFromPicker" promptText="Tá»« ngÃ y" style="-fx-background-color: white; -fx-border-color: transparent; -fx-border-width: 0; -fx-border-radius: 20px; -fx-background-radius: 20px;" HBox.hgrow="ALWAYS" />
                            <DatePicker fx:id="dobToPicker" promptText="Äáº¿n ngÃ y" style="-fx-background-color: white; -fx-border-color: transparent; -fx-border-width: 0; -fx-border-radius: 20px; -fx-background-radius: 20px;" HBox.hgrow="ALWAYS" />
                        </HBox>
                    </VBox>

                    <HBox spacing="8">
                        <Button fx:id="applyFilterButton" onAction="#applyFilters" prefWidth="100" styleClass="btn-success" text="Lá»c" />
                        <Button fx:id="resetFilterButton" onAction="#resetFilters" prefWidth="100" styleClass="btn-delete" text="Há»§y" />
                    </HBox>

                    <Separator />

                    <ListView fx:id="customerListView" VBox.vgrow="ALWAYS" />
                </VBox>
            </TitledPane>
        </VBox>
    </items>

    <!-- RIGHT PANEL: Customer Details -->
    <items>
        <BorderPane>
            <top>
                <VBox>
                    <HBox alignment="CENTER_LEFT" spacing="16.0" styleClass="hbox-header">
                        <padding>
                            <Insets bottom="16.0" left="24.0" right="24.0" top="16.0" />
                        </padding>

                        <Label fx:id="customerNameLabel" styleClass="page-title" text="[CHá»ŒN Bá»†NH NHÃ‚N]" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button fx:id="editCustomerButton" onAction="#handleEditCustomer" styleClass="btn-success" text="âœ Chá»‰nh sá»­a" />
                    </HBox>

                    <Separator />

                    <!-- Thu gá»n GridPane thÃ´ng tin bá»‡nh nhÃ¢n -->
                    <HBox spacing="20.0" style="-fx-padding: 12 24;">
                        <VBox spacing="8">
                            <HBox spacing="10">
                                <Label style="-fx-min-width: 70px;" styleClass="form-label" text="MÃ£ BN:" />
                                <Label fx:id="customerIdValueLabel" style="-fx-font-size: 14px; -fx-text-fill: #2C3E50; -fx-font-weight: 700;" text="-" />
                            </HBox>
                            <HBox spacing="10">
                                <Label style="-fx-min-width: 70px;" styleClass="form-label" text="Giá»›i tÃ­nh:" />
                                <Label fx:id="customerGenderValueLabel" style="-fx-font-size: 14px; -fx-text-fill: #2C3E50;" text="-" />
                            </HBox>
                        </VBox>
                        <VBox spacing="8">
                            <HBox spacing="10">
                                <Label style="-fx-min-width: 80px;" styleClass="form-label" text="NgÃ y sinh:" />
                                <Label fx:id="customerDobValueLabel" style="-fx-font-size: 14px; -fx-text-fill: #2C3E50;" text="-" />
                            </HBox>
                            <HBox spacing="10">
                                <Label style="-fx-min-width: 80px;" styleClass="form-label" text="Tuá»•i:" />
                                <Label fx:id="customerAgeValueLabel" style="-fx-font-size: 14px; -fx-text-fill: #2C3E50;" text="-" />
                            </HBox>
                        </VBox>
                    </HBox>

                    <Separator />
                </VBox>
            </top>

            <center>
                <TabPane styleClass="financial-tabs" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">
                    <tabs>
                        <!-- TAB 1: Overview -->
                        <Tab text="ðŸ“‹ Tá»•ng Quan">
                            <VBox spacing="16">
                                <padding>
                                    <Insets bottom="24.0" left="24.0" right="24.0" top="24.0" />
                                </padding>

                                <TitledPane expanded="true" style="-fx-background-color: white !important; -fx-border-color: rgba(14, 165, 233, 0.25) !important; -fx-border-width: 2px !important; -fx-border-radius: 12px !important; -fx-effect: dropshadow(gaussian, rgba(14, 165, 233, 0.2), 20, 0, 0, 5) !important;" text="ðŸ“ THÃ”NG TIN CHI TIáº¾T">
                                    <GridPane hgap="12" vgap="15">
                                        <padding>
                                            <Insets bottom="15" left="15" right="15" top="15" />
                                        </padding>
                                        <columnConstraints>
                                            <ColumnConstraints halignment="RIGHT" minWidth="100" />
                                            <ColumnConstraints hgrow="ALWAYS" />
                                        </columnConstraints>

                                        <Label styleClass="form-label" text="Äá»‹a chá»‰:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                        <TextField fx:id="addressField" editable="false" styleClass="text-field" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                                        <Label styleClass="form-label" text="Äiá»‡n thoáº¡i:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                        <TextField fx:id="phoneField" editable="false" styleClass="text-field" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                        <Label styleClass="form-label" text="Email:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                        <TextField fx:id="emailField" editable="false" styleClass="text-field" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                                        <Label styleClass="form-label" text="Ghi chÃº:" GridPane.columnIndex="0" GridPane.rowIndex="3" GridPane.valignment="TOP">
                                            <padding>
                                                <Insets top="8.0" />
                                            </padding>
                                        </Label>
                                        <TextArea fx:id="notesArea" editable="false" prefRowCount="4" styleClass="text-area" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                              <rowConstraints>
                                 <RowConstraints />
                                 <RowConstraints />
                                 <RowConstraints />
                                 <RowConstraints />
                              </rowConstraints>
                                    </GridPane>
                                </TitledPane>
                            </VBox>
                        </Tab>

                        <!-- TAB 2: Exam History -->
                        <Tab text="ðŸ“‹ Lá»‹ch sá»­ KhÃ¡m &amp; KÃª Ä‘Æ¡n">
                            <BorderPane>
                                <top>
                                    <HBox alignment="CENTER_RIGHT" spacing="12.0" styleClass="filter-bar">
                                        <padding>
                                            <Insets bottom="12.0" left="24.0" right="24.0" top="12.0" />
                                        </padding>
                                    </HBox>
                                </top>

                                <center>
                                    <TableView fx:id="examHistoryTable" minHeight="400.0" prefHeight="600.0" styleClass="financial-table" VBox.vgrow="ALWAYS">
                                        <columns>
                                            <TableColumn fx:id="signedAtCollumn" prefWidth="120" text="NgÃ y KhÃ¡m" />
                                            <TableColumn fx:id="appointmentIdCollumn" prefWidth="200" text="ID Buá»•i khÃ¡m" />
                                            <TableColumn fx:id="chiefComplaintCollumn" prefWidth="300" text="LÃ½ Do KhÃ¡m" />
                                            <TableColumn fx:id="diagnosisCollumn" prefWidth="300" text="Cháº©n ÄoÃ¡n" />
                                        </columns>
                                        <columnResizePolicy>
                                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                        </columnResizePolicy>
                                        <placeholder>
                                            <VBox alignment="CENTER" spacing="10">
                                                <padding>
                                                    <Insets bottom="40" left="40" right="40" top="40" />
                                                </padding>
                                                <Label text="ChÆ°a cÃ³ lá»‹ch sá»­ khÃ¡m bá»‡nh" />
                                                <Label text="ThÃªm há»“ sÆ¡ khÃ¡m má»›i Ä‘á»ƒ báº¯t Ä‘áº§u" />
                                            </VBox>
                                        </placeholder>
                                    </TableView>
                                </center>
                            </BorderPane>
                        </Tab>
                    </tabs>
                </TabPane>
            </center>
        </BorderPane>
    </items>
</SplitPane>
    </center>
</BorderPane>

