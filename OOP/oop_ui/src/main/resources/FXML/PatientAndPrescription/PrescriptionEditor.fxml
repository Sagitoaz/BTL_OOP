<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<BorderPane prefHeight="800.0" prefWidth="1200.0" styleClass="main-container" stylesheets="@../../css/main.css,@../../css/forms.css,@../../css/buttons.css,@../../css/layouts.css,@../../css/tables.css,@../../css/financial-report.css" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.oop.Control.PatientAndPrescription.PrescriptionEditorController">

    <!-- TOP: Header -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="16.0" styleClass="financial-header">
            <padding>
                <Insets bottom="16.0" left="24.0" right="24.0" top="16.0" />
            </padding>
            <Label styleClass="page-title" text="Há»’ SÆ  KHÃM &amp; KÃŠ ÄÆ N" />
            <Region HBox.hgrow="ALWAYS" />
        </HBox>
    </top>

    <!-- CENTER: Form -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="scroll-pane">
            <VBox spacing="16.0">
                <padding>
                    <Insets bottom="24.0" left="24.0" right="24.0" top="24.0" />
                </padding>

                <!-- Basic Info -->
                <TitledPane expanded="true" styleClass="titled-pane" text="ðŸ“ THÃ”NG TIN CÆ¡ Báº¢N">
                    <GridPane hgap="12" vgap="12">
                        <padding>
                            <Insets bottom="15" left="15" right="15" top="15" />
                        </padding>
                        <columnConstraints>
                            <ColumnConstraints halignment="RIGHT" minWidth="100" />
                            <ColumnConstraints hgrow="ALWAYS" />
                            <ColumnConstraints halignment="RIGHT" minWidth="100" />
                            <ColumnConstraints hgrow="ALWAYS" />
                        </columnConstraints>

                        <Label styleClass="form-label" text="Bá»‡nh nhÃ¢n:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                        <TextField fx:id="patientNameField" editable="false" styleClass="text-field" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                        <Label styleClass="form-label" text="BÃ¡c sÄ©:" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                        <TextField fx:id="doctorNameField" styleClass="text-field" GridPane.columnIndex="3" GridPane.rowIndex="0" />

                        <Label styleClass="form-label" text="NgÃ y khÃ¡m:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                        <DatePicker fx:id="examDatePicker" maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                  <rowConstraints>
                     <RowConstraints />
                     <RowConstraints />
                  </rowConstraints>
                    </GridPane>
                </TitledPane>

                <!-- Chief Complaint -->
                <TitledPane expanded="true" styleClass="titled-pane" text="LÃ DO KHÃM &amp; TIá»€N Sá»¬">
                    <VBox spacing="10">
                        <padding>
                            <Insets bottom="15" left="15" right="15" top="15" />
                        </padding>
                        <Label styleClass="form-label" text="LÃ½ do chÃ­nh (Chief Complaint):" />
                        <TextField fx:id="chiefComplaintField" promptText="VD: Máº¯t má» khi nhÃ¬n xa, kiá»ƒm tra Ä‘á»‹nh ká»³, khÃ´ máº¯t..." styleClass="text-field" />
                    </VBox>
                </TitledPane>

                <!-- Objective Measurements -->
                <TitledPane expanded="true" styleClass="titled-pane" text="ðŸ“Š THÃ”NG Sá» ÄO Äáº C">
                    <VBox spacing="12">
                        <padding>
                            <Insets bottom="15" left="15" right="15" top="15" />
                        </padding>
                        <Label styleClass="form-label" text="Káº¿t quáº£ Ä‘o khÃºc xáº¡:" />
                        <TextArea fx:id="refractionNotesArea" prefRowCount="4" promptText="Ghi chÃº káº¿t quáº£ Ä‘o báº±ng mÃ¡y hoáº·c retinoscopy..." styleClass="text-area" wrapText="true" />
                    </VBox>
                </TitledPane>

                <!-- Prescription -->
                <TitledPane expanded="true" styleClass="titled-pane" text="ðŸ‘“ ÄÆ N KÃNH THUá»C">
                    <VBox spacing="15.0">
                        <padding>
                            <Insets bottom="15" left="15" right="15" top="15" />
                        </padding>

                        <GridPane hgap="8" vgap="10">
                            <columnConstraints>
                                <ColumnConstraints minWidth="80.0" />
                                <ColumnConstraints prefWidth="80" />
                                <ColumnConstraints prefWidth="80" />
                                <ColumnConstraints prefWidth="80" />
                                <ColumnConstraints prefWidth="80" />
                                <ColumnConstraints prefWidth="80" />
                                <ColumnConstraints prefWidth="120" />
                                <ColumnConstraints prefWidth="80" />
                            </columnConstraints>

                            <Label styleClass="form-label" text="" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                            <Label styleClass="form-label" text="SPH" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                            <Label styleClass="form-label" text="CYL" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                            <Label styleClass="form-label" text="AXIS" GridPane.columnIndex="3" GridPane.rowIndex="0" />
                            <Label styleClass="form-label" text="VA" GridPane.columnIndex="4" GridPane.rowIndex="0" />
                            <Label styleClass="form-label" text="PRISM" GridPane.columnIndex="5" GridPane.rowIndex="0" />
                            <Label styleClass="form-label" text="BASE" GridPane.columnIndex="6" GridPane.rowIndex="0" />
                            <Label styleClass="form-label" text="ADD" GridPane.columnIndex="7" GridPane.rowIndex="0" />

                            <Label styleClass="form-label" text="Máº¯t Pháº£i (OD)" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                            <TextField fx:id="sphOdField" prefWidth="80" promptText="+/-#.##" styleClass="text-field" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                            <TextField fx:id="cylOdField" prefWidth="80" promptText="-#.##" styleClass="text-field" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                            <TextField fx:id="axisOdField" prefWidth="80" promptText="0-180" styleClass="text-field" GridPane.columnIndex="3" GridPane.rowIndex="1" />
                            <TextField fx:id="vaOdField" prefWidth="80" promptText="20/20" styleClass="text-field" GridPane.columnIndex="4" GridPane.rowIndex="1" />
                            <TextField fx:id="prismOdField" prefWidth="80" promptText="#.##" styleClass="text-field" GridPane.columnIndex="5" GridPane.rowIndex="1" />
                            <ComboBox fx:id="baseOdCombo" prefWidth="120" promptText="In/Out/Up/Down" styleClass="combo-rounded" GridPane.columnIndex="6" GridPane.rowIndex="1" />
                            <TextField fx:id="addOdField" prefWidth="80" promptText="+#.##" styleClass="text-field" GridPane.columnIndex="7" GridPane.rowIndex="1" />

                            <Label styleClass="form-label" text="Máº¯t TrÃ¡i (OS)" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                            <TextField fx:id="sphOsField" prefWidth="80" promptText="+/-#.##" styleClass="text-field" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                            <TextField fx:id="cylOsField" prefWidth="80" promptText="-#.##" styleClass="text-field" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                            <TextField fx:id="axisOsField" prefWidth="80" promptText="0-180" styleClass="text-field" GridPane.columnIndex="3" GridPane.rowIndex="2" />
                            <TextField fx:id="vaOsField" prefWidth="80" promptText="20/20" styleClass="text-field" GridPane.columnIndex="4" GridPane.rowIndex="2" />
                            <TextField fx:id="prismOsField" prefWidth="80" promptText="#.##" styleClass="text-field" GridPane.columnIndex="5" GridPane.rowIndex="2" />
                            <ComboBox fx:id="baseOsCombo" prefWidth="120" promptText="In/Out/Up/Down" styleClass="combo-rounded" GridPane.columnIndex="6" GridPane.rowIndex="2" />
                            <TextField fx:id="addOsField" prefWidth="80" promptText="+#.##" styleClass="text-field" GridPane.columnIndex="7" GridPane.rowIndex="2" />
                     <rowConstraints>
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints />
                     </rowConstraints>
                        </GridPane>

                        <Separator />

                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label styleClass="form-label" text="PD (Khoáº£ng cÃ¡ch Ä‘á»“ng tá»­):" />
                            <TextField fx:id="pdField" prefWidth="100" promptText="## mm" styleClass="text-field" />
                        </HBox>

                        <Separator />

                        <Label styleClass="form-label" text="Ghi chÃº thÃªm cho Ä‘Æ¡n kÃ­nh:" />
                        <TextArea fx:id="prescriptionNotesArea" prefRowCount="3" promptText="VD: MÃ i má»ng chiáº¿t suáº¥t cao, Æ°u tiÃªn trÃ²ng nháº¹..." styleClass="text-area" wrapText="true" />

                        <Separator />

                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label styleClass="form-label" text="Loáº¡i trÃ²ng kÃ­nh:" />
                            <ComboBox fx:id="lensTypeCombo" prefWidth="250.0" promptText="Chá»n loáº¡i trÃ²ng kÃ­nh" styleClass="combo-rounded" />
                        </HBox>

                        <VBox spacing="10">
                            <Label styleClass="form-label" text="TÆ° váº¥n TrÃ²ng kÃ­nh:" />
                            <GridPane hgap="20" vgap="8">
                                <columnConstraints>
                                    <ColumnConstraints hgrow="ALWAYS" />
                                    <ColumnConstraints hgrow="ALWAYS" />
                                </columnConstraints>

                                <CheckBox fx:id="arCheck" text="Lá»›p phá»§ chá»‘ng pháº£n quang (AR)" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                <CheckBox fx:id="blueLightCheck" text="Lá»c Ã¡nh sÃ¡ng xanh (Blue Light Filter)" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                                <CheckBox fx:id="uvCheck" text="Chá»‘ng tia UV (UV Protection)" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                <CheckBox fx:id="photochromicCheck" text="Äá»•i mÃ u (Photochromic)" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                        <rowConstraints>
                           <RowConstraints />
                           <RowConstraints />
                        </rowConstraints>
                            </GridPane>

                            <HBox alignment="CENTER_LEFT" spacing="12">
                                <Label styleClass="form-label" text="Cháº¥t liá»‡u Ä‘á» nghá»‹:" />
                                <ComboBox fx:id="materialCombo" prefWidth="300.0" promptText="Chá»n cháº¥t liá»‡u/chiáº¿t suáº¥t" styleClass="combo-rounded" />
                            </HBox>
                        </VBox>
                    </VBox>
                </TitledPane>

                <!-- Diagnosis & Plan -->
                <TitledPane expanded="true" styleClass="titled-pane" text="ðŸ“‹ CHáº¨N ÄOÃN &amp; Káº¾ HOáº CH">
                    <VBox spacing="12">
                        <padding>
                            <Insets bottom="15" left="15" right="15" top="15" />
                        </padding>

                        <Label styleClass="form-label" text="Cháº©n Ä‘oÃ¡n (Assessment / Diagnosis):" />
                        <TextArea fx:id="assessmentArea" prefRowCount="4" promptText="VD: Cáº­n thá»‹, LÃ£o thá»‹, Äá»¥c thá»§y tinh thá»ƒ máº¯t pháº£i..." styleClass="text-area" wrapText="true" />

                        <Label styleClass="form-label" text="Káº¿ hoáº¡ch Ä‘iá»u trá»‹ (Plan):" />
                        <TextArea fx:id="planArea" prefRowCount="4" promptText="VD: KÃª Ä‘Æ¡n kÃ­nh má»›i, háº¹n tÃ¡i khÃ¡m 1 nÄƒm, theo dÃµi nhÃ£n Ã¡p..." styleClass="text-area" wrapText="true" />
                    </VBox>
                </TitledPane>
            </VBox>
        </ScrollPane>
    </center>

    <!-- BOTTOM: Action Buttons -->
    <bottom>
        <VBox>
            <Separator />
            <HBox alignment="CENTER_RIGHT" spacing="12" styleClass="financial-header">
                <padding>
                    <Insets bottom="16.0" left="24.0" right="24.0" top="16.0" />
                </padding>
                <Button onAction="#handleCancel" prefWidth="100" styleClass="btn-secondary" text="âŒ Há»§y" />
                <Button onAction="#handleSavePrescription" prefHeight="43.0" prefWidth="163.0" styleClass="btn-success" text="ðŸ’¾ LÆ°u ÄÆ¡n KhÃ¡m" />
                <Button prefWidth="180" styleClass="btn-print" text="ðŸ–¨ LÆ°u &amp; In ÄÆ¡n KÃ­nh" />
            </HBox>
        </VBox>
    </bottom>
</BorderPane>
