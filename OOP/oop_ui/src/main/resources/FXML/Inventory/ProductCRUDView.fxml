<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Tooltip?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<BorderPane prefHeight="800.0" prefWidth="1280.0" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.oop.Control.Inventory.ProductCRUDController">

    <!-- TOP: Header with title and quick actions -->
    <top>
        <VBox>
            <HBox alignment="CENTER_LEFT" spacing="15">
                <padding><Insets bottom="15" left="20" right="20" top="15" /></padding>
                <Label text="Product Management" />
                <Region HBox.hgrow="ALWAYS" />
                <Button fx:id="addNewButton" onAction="#onClear" text="Add New Product">
                    <tooltip><Tooltip text="Create a new product" /></tooltip>
                </Button>
            </HBox>
            <Separator />
        </VBox>
    </top>

    <center>
        <SplitPane dividerPositions="0.65">
            <!-- LEFT: Search + Table Panel -->
            <VBox spacing="15">
                <padding><Insets bottom="15" left="15" right="15" top="15" /></padding>

                <!-- Search Section -->
                <VBox spacing="10">
                    <Label text="Search and Filter" />
                    
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <TextField fx:id="searchField" prefHeight="36" promptText="Search by name, SKU, or category..." HBox.hgrow="ALWAYS">
                            <tooltip><Tooltip text="Search products by name, SKU, or category" /></tooltip>
                        </TextField>
                        
                        <ComboBox fx:id="filterCategoryBox" prefWidth="160" promptText="All Categories">
                            <tooltip><Tooltip text="Filter by category" /></tooltip>
                        </ComboBox>
                        
                        <Button fx:id="clearFilterButton" onAction="#onClearFilter" text="Clear">
                            <tooltip><Tooltip text="Clear all filters" /></tooltip>
                        </Button>
                    </HBox>
                </VBox>

                <Separator />

                <!-- Table Section -->
                <VBox spacing="8" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label text="Product List" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="recordCountLabel" text="0 products" />
                    </HBox>

                    <TableView fx:id="productTable" VBox.vgrow="ALWAYS">
                        <columnResizePolicy>
                            <TableView fx:constant="UNCONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>

                        <columns>
                            <TableColumn fx:id="idColumn" prefWidth="60" minWidth="60" text="ID" />
                            <TableColumn fx:id="skuColumn" prefWidth="120" minWidth="120" text="SKU" />
                            <TableColumn fx:id="nameColumn" prefWidth="220" minWidth="200" text="Product Name" />
                            <TableColumn fx:id="categoryColumn" prefWidth="140" minWidth="140" text="Category" />
                            <TableColumn fx:id="quantityColumn" prefWidth="80" minWidth="80" text="Stock" />
                            <TableColumn fx:id="priceColumn" prefWidth="120" minWidth="120" text="Price (VND)" />
                            <TableColumn fx:id="statusColumn" prefWidth="100" minWidth="100" text="Status" />
                        </columns>

                        <placeholder>
                            <VBox alignment="CENTER" spacing="10">
                                <padding><Insets bottom="40" left="40" right="40" top="40" /></padding>
                                <Label text="No products found" />
                                <Label text="Try adjusting your search criteria" />
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>
            </VBox>

            <!-- RIGHT: Form Panel -->
            <ScrollPane fitToHeight="true" fitToWidth="true" SplitPane.resizableWithParent="false">
                <content>
                    <VBox maxWidth="450" prefWidth="420" spacing="20">
                        <padding><Insets bottom="25" left="25" right="25" top="25" /></padding>

                        <!-- Form Header -->
                        <VBox spacing="5">
                            <Label fx:id="formTitleLabel" text="Product Details" />
                            <Separator />
                        </VBox>

                        <!-- Form Fields -->
                        <GridPane hgap="15" vgap="15">
                            <columnConstraints>
                                <ColumnConstraints halignment="RIGHT" minWidth="110" />
                                <ColumnConstraints hgrow="ALWAYS" />
                            </columnConstraints>

                            <!-- SKU Field -->
                            <Label text="SKU:" GridPane.rowIndex="0" />
                            <TextField fx:id="skuField" promptText="e.g. PROD-001" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                <tooltip><Tooltip text="Unique product identifier (Stock Keeping Unit)" /></tooltip>
                            </TextField>

                            <!-- Name Field -->
                            <Label text="Name:" GridPane.rowIndex="1" />
                            <TextField fx:id="nameField" promptText="Enter product name" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                <tooltip><Tooltip text="Full product name" /></tooltip>
                            </TextField>

                            <!-- Category Field -->
                            <Label text="Category:" GridPane.rowIndex="2" />
                            <ComboBox fx:id="categoryBox" prefWidth="200" promptText="Select category" GridPane.columnIndex="1" GridPane.rowIndex="2">
                                <tooltip><Tooltip text="Product category" /></tooltip>
                            </ComboBox>

                            <!-- Quantity Field -->
                            <Label text="Stock Qty:" GridPane.rowIndex="3" />
                            <HBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="3">
                                <TextField fx:id="quantityField" prefWidth="120" promptText="0">
                                    <tooltip><Tooltip text="Current stock quantity" /></tooltip>
                                </TextField>
                                <TextField fx:id="unitField" prefWidth="80" promptText="pcs">
                                    <tooltip><Tooltip text="Unit of measurement (e.g. pcs, kg, liters)" /></tooltip>
                                </TextField>
                            </HBox>

                            <!-- Price Field -->
                            <Label text="Unit Price:" GridPane.rowIndex="4" />
                            <TextField fx:id="priceField" promptText="0.00 VND" GridPane.columnIndex="1" GridPane.rowIndex="4">
                                <tooltip><Tooltip text="Price per unit in VND" /></tooltip>
                            </TextField>

                            <!-- Status Field -->
                            <Label text="Status:" GridPane.rowIndex="5" />
                            <ComboBox fx:id="statusBox" prefWidth="200" promptText="Active" GridPane.columnIndex="1" GridPane.rowIndex="5">
                                <tooltip><Tooltip text="Product status (Active/Inactive/Discontinued)" /></tooltip>
                            </ComboBox>

                            <!-- Description Field -->
                            <Label text="Description:" GridPane.rowIndex="6" GridPane.valignment="TOP" />
                            <TextArea fx:id="descriptionArea" prefRowCount="4" promptText="Enter product description..." wrapText="true" GridPane.columnIndex="1" GridPane.rowIndex="6">
                                <tooltip><Tooltip text="Detailed product description" /></tooltip>
                            </TextArea>

                            <rowConstraints>
                                <RowConstraints />
                                <RowConstraints />
                                <RowConstraints />
                                <RowConstraints />
                                <RowConstraints />
                                <RowConstraints />
                                <RowConstraints />
                            </rowConstraints>
                        </GridPane>

                        <Separator />

                        <!-- Action Buttons -->
                        <VBox spacing="10">
                            <HBox alignment="CENTER" spacing="12">
                                <Button fx:id="saveButton" defaultButton="true" onAction="#onSave" prefWidth="120" text="Save">
                                    <tooltip><Tooltip text="Save product changes" /></tooltip>
                                </Button>
                                <Button fx:id="clearButton" cancelButton="true" onAction="#onClear" prefWidth="120" text="Clear">
                                    <tooltip><Tooltip text="Clear all form fields" /></tooltip>
                                </Button>
                            </HBox>
                            
                            <HBox alignment="CENTER" spacing="12" />
                        </VBox>
                    </VBox>
                </content>
            </ScrollPane>
        </SplitPane>
    </center>

    <!-- BOTTOM: Action Bar -->
    <bottom>
        <VBox>
            <Separator />
            <HBox alignment="CENTER_LEFT" spacing="15">
                <padding><Insets bottom="12" left="20" right="20" top="12" /></padding>
                <!-- Left Side Actions -->
                <HBox spacing="10">
                    <Button fx:id="deleteButton" onAction="#onDelete" text="Delete Selected">
                        <tooltip><Tooltip text="Delete selected product (cannot be undone)" /></tooltip>
                    </Button>
                    
                    <Button fx:id="exportButton" onAction="#onExport" text="Export">
                        <tooltip><Tooltip text="Export products to CSV/Excel" /></tooltip>
                    </Button>
                    
                    <Button fx:id="importButton" onAction="#onImport" text="Import">
                        <tooltip><Tooltip text="Import products from file" /></tooltip>
                    </Button>
                </HBox>

                <Region HBox.hgrow="ALWAYS" />

                <!-- Right Side Status -->
                <HBox alignment="CENTER_RIGHT" spacing="15">
                    <VBox alignment="CENTER_RIGHT" spacing="2">
                        <Label fx:id="totalValueLabel" text="Total Value: 0 VND" />
                        <Label fx:id="lowStockLabel" text="Low Stock: 0 items" />
                    </VBox>
                    
                    <Separator orientation="VERTICAL" prefHeight="30" />
                    
                    <VBox alignment="CENTER_RIGHT" spacing="2">
                        <Label fx:id="statusLabel" text="Ready" />
                        <Label fx:id="lastUpdateLabel" text="Last updated: Never" />
                    </VBox>
                </HBox>
            </HBox>
        </VBox>
    </bottom>

</BorderPane>
