<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.control.Tooltip?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="800.0" prefWidth="1200.0" styleClass="main-container" stylesheets="@../../css/main.css,@../../css/forms.css,@../../css/buttons.css,@../../css/layouts.css,@../../css/financial-report.css,@../../css/navigation.css,@../../css/global-styles.css,@../../css/tables.css" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.oop.Control.Inventory.ProductCRUDController">

    <!-- TOP: Header with Professional Styling -->
    <top>
        <VBox>
            <!-- Navigation Bar -->
            <HBox alignment="CENTER_LEFT" spacing="8" style="-fx-padding: 12px 20px;" styleClass="navigation-bar">
                <Button fx:id="backButton" onAction="#handleBackButton" styleClass="nav-button nav-back-button" text="â—€ Quay láº¡i" />
                <Button fx:id="forwardButton" onAction="#handleForwardButton" styleClass="nav-button nav-forward-button" text="Tiáº¿n â–¶" />
                <Button fx:id="reloadButton" onAction="#handleReloadButton" styleClass="nav-button nav-reload-button" text="âŸ³ Táº£i láº¡i" />
            </HBox>
            
            <!-- Header vá»›i tiÃªu Ä‘á» vÃ  button thÃªm má»›i -->
            <HBox alignment="CENTER_LEFT" spacing="16.0" style="-fx-background-color: linear-gradient(to right, #0EA5E9, #0284C7); -fx-padding: 20px 24px; -fx-effect: dropshadow(gaussian, rgba(14,165,233,0.3), 15, 0, 0, 4);" styleClass="financial-header">
                <padding>
                    <Insets bottom="16.0" left="24.0" right="24.0" top="16.0" />
                </padding>
                <children>
                    <Label style="-fx-text-fill: white; -fx-font-size: 24px; -fx-font-weight: 700; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 2, 0, 0, 1);" styleClass="page-title" text="ðŸ“¦ QUáº¢N LÃ Sáº¢N PHáº¨M" />
                    <Region HBox.hgrow="ALWAYS" />
                   <Button fx:id="deleteButton" onAction="#onDelete" styleClass="btn-danger" text="ðŸ—‘ XÃ³a">
                       <tooltip>
                     <Tooltip text="XÃ³a sáº£n pháº©m Ä‘Ã£ chá»n" />
                  </tooltip>
                   </Button>
                    <Button fx:id="addNewButton" onAction="#onAddInventory" styleClass="btn-success" text="âž• ThÃªm má»›i" />
                </children>
            </HBox>

            <!-- Search vÃ  Filter Bar -->
            <HBox alignment="CENTER_LEFT" spacing="12.0" style="-fx-padding: 12px 24px; -fx-background-color: white; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 8, 0, 0, 2);">
                <children>
                    <Label styleClass="form-label" text="TÃ¬m kiáº¿m:" />
                    <TextField fx:id="searchField" prefWidth="250.0" promptText="TÃ¬m kiáº¿m theo tÃªn, SKU..." styleClass="text-field">
                        <tooltip><Tooltip text="TÃ¬m kiáº¿m theo tÃªn, SKU, danh má»¥c" /></tooltip>
                    </TextField>

                    <Separator orientation="VERTICAL" />

                    <Label styleClass="form-label" text="Lá»c:" />
                    <ComboBox fx:id="filterCategoryBox" prefWidth="180.0" promptText="Chá»n danh má»¥c" style="-fx-text-fill: #0066CC; -fx-prompt-text-fill: #0066CC;" styleClass="combo-rounded">
                        <tooltip><Tooltip text="Lá»c theo danh má»¥c" /></tooltip>
                    </ComboBox>
                    <Button fx:id="clearFilterButton" onAction="#onClearFilter" styleClass="btn-secondary" text="XÃ³a lá»c" />

                    <Region HBox.hgrow="ALWAYS" />

                    <Button fx:id="exportButton" onAction="#onExport" styleClass="export-button" text="ðŸ“Š Export" />
                    <Button fx:id="importButton" onAction="#onImport" styleClass="btn-import" text="ðŸ“¥ Import" />
                </children>
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToHeight="true" fitToWidth="true" styleClass="scroll-pane">
            <content>
                <GridPane hgap="16" vgap="16">
                    <padding>
                        <Insets bottom="24.0" left="24.0" right="24.0" top="24.0" />
                    </padding>
                    <columnConstraints>
                        <ColumnConstraints percentWidth="60.0" />
                        <ColumnConstraints percentWidth="40.0" />
                    </columnConstraints>

                    <!-- LEFT: Product List Table -->
                    <TitledPane expanded="true" style="-fx-background-color: white; -fx-border-color: #BAE6FD; -fx-border-width: 2px; -fx-border-radius: 12px;" text="ðŸ“‹ DANH SÃCH Sáº¢N PHáº¨M" GridPane.columnIndex="0" GridPane.rowIndex="0">
                        <content>
                            <VBox spacing="12.0">
                                <padding>
                                    <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                </padding>
                                <children>
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Label fx:id="recordCountLabel" styleClass="form-label" text="0 sáº£n pháº©m" />
                                        <Region HBox.hgrow="ALWAYS" />
                                        <Label fx:id="totalValueLabel" styleClass="form-label" text="Tá»•ng giÃ¡ trá»‹: 0 VNÄ" />
                                    </HBox>

                                    <TableView fx:id="productTable" prefHeight="500.0" styleClass="financial-table">
                                        <columns>
                                            <TableColumn fx:id="idColumn" prefWidth="50" text="ID" />
                                            <TableColumn fx:id="skuColumn" prefWidth="70.0" text="SKU" />
                                            <TableColumn fx:id="nameColumn" prefWidth="172.0" text="TÃªn sáº£n pháº©m" />
                                            <TableColumn fx:id="categoryColumn" prefWidth="115.0" text="Danh má»¥c" />
                                            <TableColumn fx:id="quantityColumn" prefWidth="91.0" text="Tá»“n kho" />
                                            <TableColumn fx:id="priceColumn" prefWidth="115.0" text="GiÃ¡ (VNÄ)" />
                                            <TableColumn fx:id="statusColumn" prefWidth="157.0" text="Tráº¡ng thÃ¡i" />
                                        </columns>
                                        <placeholder>
                                            <VBox alignment="CENTER" spacing="10">
                                                <padding><Insets bottom="40" left="40" right="40" top="40" /></padding>
                                                <Label text="KhÃ´ng tÃ¬m tháº¥y sáº£n pháº©m" />
                                                <Label text="Thá»­ Ä‘iá»u chá»‰nh bá»™ lá»c cá»§a báº¡n" />
                                            </VBox>
                                        </placeholder>
                                    </TableView>
                                </children>
                            </VBox>
                        </content>
                    </TitledPane>

                    <!-- RIGHT: Product Form -->
                    <VBox spacing="16.0" GridPane.columnIndex="1" GridPane.rowIndex="0">
                        <!-- Form Details -->
                        <TitledPane expanded="true" style="-fx-background-color: white; -fx-border-color: #BAE6FD; -fx-border-width: 2px; -fx-border-radius: 12px;" text="ðŸ“ CHI TIáº¾T Sáº¢N PHáº¨M">
                            <content>
                                <ScrollPane fitToHeight="true" fitToWidth="true" styleClass="scroll-pane">
                                    <content>
                                        <VBox spacing="15">
                                            <padding>
                                                <Insets bottom="15" left="15" right="15" top="15" />
                                            </padding>
                                            <children>
                                                <GridPane hgap="12" vgap="12">
                                                    <columnConstraints>
                                                        <ColumnConstraints halignment="RIGHT" minWidth="90" />
                                                        <ColumnConstraints hgrow="ALWAYS" />
                                                    </columnConstraints>

                                                    <Label styleClass="form-label" text="SKU:" GridPane.rowIndex="0" />
                                                    <TextField fx:id="skuField" promptText="PROD-001" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                        <tooltip><Tooltip text="MÃ£ sáº£n pháº©m duy nháº¥t" /></tooltip>
                                                    </TextField>

                                                    <Label styleClass="form-label" text="TÃªn:" GridPane.rowIndex="1" />
                                                    <TextField fx:id="nameField" promptText="Nháº­p tÃªn sáº£n pháº©m" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                        <tooltip><Tooltip text="TÃªn Ä‘áº§y Ä‘á»§ cá»§a sáº£n pháº©m" /></tooltip>
                                                    </TextField>

                                                    <Label styleClass="form-label" text="Danh má»¥c:" GridPane.rowIndex="2" />
                                                    <ComboBox fx:id="categoryBox" prefWidth="200" promptText="Chá»n danh má»¥c" style="-fx-text-fill: #0066CC; -fx-prompt-text-fill: #0066CC;" styleClass="combo-rounded" GridPane.columnIndex="1" GridPane.rowIndex="2">
                                                        <tooltip><Tooltip text="Danh má»¥c sáº£n pháº©m" /></tooltip>
                                                    </ComboBox>

                                                    <Label styleClass="form-label" text="Sá»‘ lÆ°á»£ng:" GridPane.rowIndex="3" />
                                                    <HBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="3">
                                                        <TextField fx:id="quantityField" prefWidth="100" promptText="0">
                                                            <tooltip><Tooltip text="Sá»‘ lÆ°á»£ng tá»“n kho" /></tooltip>
                                                        </TextField>
                                                        <TextField fx:id="unitField" prefWidth="70" promptText="cÃ¡i">
                                                            <tooltip><Tooltip text="ÄÆ¡n vá»‹ Ä‘o" /></tooltip>
                                                        </TextField>
                                                    </HBox>

                                                    <Label styleClass="form-label" text="GiÃ¡ vá»‘n:" GridPane.rowIndex="4" />
                                                    <TextField fx:id="priceCostField" promptText="0 VNÄ" GridPane.columnIndex="1" GridPane.rowIndex="4">
                                                        <tooltip><Tooltip text="GiÃ¡ vá»‘n (VNÄ)" /></tooltip>
                                                    </TextField>

                                                    <Label styleClass="form-label" text="GiÃ¡ bÃ¡n:" GridPane.rowIndex="5" />
                                                    <TextField fx:id="priceRetailField" promptText="0 VNÄ" GridPane.columnIndex="1" GridPane.rowIndex="5">
                                                        <tooltip><Tooltip text="GiÃ¡ bÃ¡n láº» (VNÄ)" /></tooltip>
                                                    </TextField>

                                                    <Label styleClass="form-label" text="Tráº¡ng thÃ¡i:" GridPane.rowIndex="6" />
                                                    <ComboBox fx:id="statusBox" prefWidth="200" promptText="Hoáº¡t Ä‘á»™ng" style="-fx-text-fill: #0066CC; -fx-prompt-text-fill: #0066CC;" styleClass="combo-rounded" GridPane.columnIndex="1" GridPane.rowIndex="6">
                                                        <tooltip><Tooltip text="Tráº¡ng thÃ¡i sáº£n pháº©m" /></tooltip>
                                                    </ComboBox>

                                                    <Label styleClass="form-label" text="Batch No:" GridPane.rowIndex="7" />
                                                    <TextField fx:id="batchNoField" promptText="BATCH-001" GridPane.columnIndex="1" GridPane.rowIndex="7">
                                                        <tooltip><Tooltip text="Sá»‘ lÃ´ (náº¿u cÃ³)" /></tooltip>
                                                    </TextField>

                                                    <Label styleClass="form-label" text="Háº¡n dÃ¹ng:" GridPane.rowIndex="8" />
                                                    <TextField fx:id="expiryDateField" promptText="YYYY-MM-DD" GridPane.columnIndex="1" GridPane.rowIndex="8">
                                                        <tooltip><Tooltip text="NgÃ y háº¿t háº¡n" /></tooltip>
                                                    </TextField>

                                                    <Label styleClass="form-label" text="Serial No:" GridPane.rowIndex="9" />
                                                    <TextField fx:id="serialNoField" promptText="SERIAL-001" GridPane.columnIndex="1" GridPane.rowIndex="9">
                                                        <tooltip><Tooltip text="Sá»‘ serial" /></tooltip>
                                                    </TextField>

                                                    <Label styleClass="form-label" text="Ghi chÃº:" GridPane.rowIndex="10" />
                                                    <TextArea fx:id="noteArea" prefRowCount="3" promptText="Nháº­p ghi chÃº..." wrapText="true" GridPane.columnIndex="1" GridPane.rowIndex="10">
                                                        <tooltip><Tooltip text="Ghi chÃº thÃªm vá» sáº£n pháº©m" /></tooltip>
                                                    </TextArea>
                                       <rowConstraints>
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                          <RowConstraints />
                                       </rowConstraints>
                                                </GridPane>

                                                <Separator />

                                                <HBox alignment="CENTER" spacing="12">
                                                    <Button fx:id="saveButton" defaultButton="true" onAction="#onSave" prefWidth="120" styleClass="btn-success" text="ðŸ’¾ LÆ°u">
                                                        <tooltip><Tooltip text="LÆ°u thay Ä‘á»•i" /></tooltip>
                                                    </Button>
                                                    <Button fx:id="clearButton" cancelButton="true" onAction="#onClear" prefWidth="180.0" styleClass="btn-secondary" text="ðŸ”„ LÃ m má»›i">
                                                        <tooltip><Tooltip text="XÃ³a táº¥t cáº£ trÆ°á»ng">
                                                <font>
                                                   <Font size="10.0" />
                                                </font></Tooltip></tooltip>
                                          <font>
                                             <Font size="10.0" />
                                          </font>
                                                    </Button>
                                                </HBox>
                                            </children>
                                        </VBox>
                                    </content>
                                </ScrollPane>
                            </content>
                        </TitledPane>

                        <!-- Quick Stats -->
                        <TitledPane expanded="true" style="-fx-background-color: white; -fx-border-color: #BAE6FD; -fx-border-width: 2px; -fx-border-radius: 12px;" text="ðŸ“Š THá»NG KÃŠ NHANH">
                            <content>
                                <VBox spacing="12">
                                    <padding>
                                        <Insets bottom="15" left="15" right="15" top="15" />
                                    </padding>
                                    <children>
                                        <HBox alignment="CENTER_LEFT" spacing="10">
                                            <Label styleClass="form-label" text="Tá»“n kho tháº¥p:" />
                                            <Region HBox.hgrow="ALWAYS" />
                                            <Label fx:id="lowStockLabel" text="0 sáº£n pháº©m" />
                                        </HBox>
                                        <Separator />
                                        <HBox alignment="CENTER_LEFT" spacing="10">
                                            <Label styleClass="form-label" text="Tráº¡ng thÃ¡i:" />
                                            <Region HBox.hgrow="ALWAYS" />
                                            <Label fx:id="statusLabel" text="Sáºµn sÃ ng" />
                                        </HBox>
                                        <Separator />
                                        <VBox spacing="5">
                                            <Label styleClass="form-label" text="Cáº­p nháº­t láº§n cuá»‘i:" />
                                            <Label fx:id="lastUpdateLabel" text="ChÆ°a bao giá»" />
                                        </VBox>
                                    </children>
                                </VBox>
                            </content>
                        </TitledPane>
                    </VBox>
               <rowConstraints>
                  <RowConstraints />
               </rowConstraints>
                </GridPane>
            </content>
        </ScrollPane>
    </center>

    <!-- BOTTOM: Action Bar -->
    <bottom>
        <VBox>
            <Separator />
        </VBox>
    </bottom>

</BorderPane>
