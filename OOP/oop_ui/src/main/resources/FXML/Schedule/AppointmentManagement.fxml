<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.MenuButton?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.FlowPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.ColumnConstraints?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="800.0" prefWidth="1280.0" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.oop.Control.Schedule.AppointmentManagementController">
    <top>
        <HBox prefHeight="100.0" prefWidth="200.0" spacing="10.0" BorderPane.alignment="CENTER_LEFT">
            <padding>
                <Insets bottom="8.0" left="8.0" right="8.0" top="8.0" />
            </padding>
            <children>
                <FlowPane hgap="8.0" prefHeight="227.0" prefWidth="181.0" vgap="8.0" HBox.hgrow="ALWAYS">
                    <children>
                        <DatePicker promptText="Từ ngày" fx:id="fromDatePicker" />
                        <DatePicker promptText="Đến ngày" fx:id="toDatePicker" />
                        <ComboBox prefWidth="150.0" promptText="Bác sĩ" fx:id="doctorFilter" />
                        <ComboBox prefWidth="150.0" promptText="Phòng (nếu có)" fx:id="roomFilter" />
                        <ComboBox prefWidth="150.0" promptText="Trạng thái" fx:id="statusFilter" />
                        <TextField promptText="Tìm BN/SĐT/Mã hẹn" fx:id="qSearch" />
                        <Button mnemonicParsing="false" text="Lọc" fx:id="applyFilterBtn" onAction="#onApplyFilter" />
                        <Button mnemonicParsing="false" text="Xóa lọc" fx:id="resetFilterBtn" onAction="#onResetFilter" />
                        <Region prefHeight="26.0" prefWidth="835.0" />
                        <Button mnemonicParsing="false" text="Tạo hẹn" fx:id="createBtn" onAction="#onCreate" />
                        <Button mnemonicParsing="false" text="Duyệt" fx:id="confirmBtn" onAction="#onConfirm" />
                        <Button mnemonicParsing="false" text="Hủy" fx:id="cancelBtn" onAction="#onCancel" />
                        <MenuButton mnemonicParsing="false" text="Thao tác khác" fx:id="moreActionsBtn">
                            <items>
                                <MenuItem mnemonicParsing="false" text="Chuyển bác sĩ..." />
                                <MenuItem mnemonicParsing="false" text="Gửi SMS..." />
                                <MenuItem mnemonicParsing="false" text="Xuất CSV..." />
                            </items>
                        </MenuButton>
                    </children>
                </FlowPane>
            </children>
        </HBox>
    </top>
    <center>
        <SplitPane dividerPositions="0.6869524405506884" prefHeight="160.0" prefWidth="200.0" BorderPane.alignment="CENTER">
            <items>
                <VBox prefHeight="200.0" prefWidth="677.0" spacing="8.0">
                    <padding>
                        <Insets bottom="8.0" left="8.0" right="8.0" top="8.0" />
                    </padding>
                    <children>
                        <HBox alignment="CENTER_LEFT" prefHeight="74.0" prefWidth="859.0" spacing="8.0">
                            <children>
                                <Label text="Danh sách hẹn" />
                                <Region prefHeight="200.0" prefWidth="578.0" HBox.hgrow="ALWAYS" />
                                <CheckBox mnemonicParsing="false" text="Chỉ hiện xung đột" />
                                <Button mnemonicParsing="false" text="Làm mới" fx:id="refreshBtn" onAction="#onRefresh" />
                            </children>
                        </HBox>
                        <TableView prefHeight="200.0" prefWidth="730.0" tableMenuButtonVisible="true" VBox.vgrow="ALWAYS" fx:id="appointmentTable">
                            <columns>
                                <TableColumn prefWidth="60.0" text="ID" fx:id="colId" />
                                <TableColumn prefWidth="120.0" text="Thời gian" fx:id="colTime" />
                                <TableColumn prefWidth="100.0" text="Ngày" fx:id="colDate" />
                                <TableColumn prefWidth="200.0" text="Bệnh nhân" fx:id="colPatient" />
                                <TableColumn prefWidth="180.0" text="Bác sĩ" fx:id="colDoctor" />
                                <TableColumn prefWidth="180.0" text="Dịch vụ" fx:id="colService" />
                                <TableColumn prefWidth="100.0" text="Phòng" fx:id="colRoom" />
                                <TableColumn prefWidth="120.0" text="Trạng thái" fx:id="colStatus" />
                                <TableColumn prefWidth="200.0" text="Ghi chú" fx:id="colNote" />
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                    </children>
                </VBox>
                <TabPane prefHeight="200.0" prefWidth="200.0" tabClosingPolicy="UNAVAILABLE">
                    <tabs>
                        <Tab text="Chi tiết">
                            <content>
                                <VBox spacing="8.0">
                                    <padding>
                                        <Insets bottom="12.0" left="12.0" right="12.0" top="12.0" />
                                    </padding>
                                    <children>
                                        <GridPane hgap="12.0" vgap="8.0">
                                            <columnConstraints>
                                                <ColumnConstraints percentWidth="35.0" />
                                                <ColumnConstraints percentWidth="65.0" />
                                            </columnConstraints>
                                            <children>
                                                <Label text="Mã hẹn" GridPane.rowIndex="0" GridPane.columnIndex="0" />
                                                <TextField fx:id="txtId" editable="false" GridPane.rowIndex="0" GridPane.columnIndex="1" />
                                                <Label text="Ngày" GridPane.rowIndex="1" GridPane.columnIndex="0" />
                                                <DatePicker fx:id="datePicker" GridPane.rowIndex="1" GridPane.columnIndex="1" />
                                                <Label text="Giờ bắt đầu" GridPane.rowIndex="2" GridPane.columnIndex="0" />
                                                <TextField fx:id="startTimeField" GridPane.rowIndex="2" GridPane.columnIndex="1" />
                                                <Label text="Giờ kết thúc" GridPane.rowIndex="3" GridPane.columnIndex="0" />
                                                <TextField fx:id="endTimeField" GridPane.rowIndex="3" GridPane.columnIndex="1" />
                                                <Label text="Bệnh nhân" GridPane.rowIndex="4" GridPane.columnIndex="0" />
                                                <HBox spacing="8.0" GridPane.rowIndex="4" GridPane.columnIndex="1">
                                                    <children>
                                                        <TextField fx:id="patientField" editable="false" HBox.hgrow="ALWAYS" />
                                                        <Button text="Chọn..." fx:id="choosePatientBtn" onAction="#onChoosePatient" />
                                                    </children>
                                                </HBox>
                                                <Label text="Bác sĩ" GridPane.rowIndex="5" GridPane.columnIndex="0" />
                                                <ComboBox fx:id="doctorCombo" prefWidth="200.0" GridPane.rowIndex="5" GridPane.columnIndex="1" />
                                                <Label text="Dịch vụ" GridPane.rowIndex="6" GridPane.columnIndex="0" />
                                                <ComboBox fx:id="serviceCombo" prefWidth="200.0" GridPane.rowIndex="6" GridPane.columnIndex="1" />
                                                <Label text="Phòng" GridPane.rowIndex="7" GridPane.columnIndex="0" />
                                                <ComboBox fx:id="roomCombo" prefWidth="200.0" GridPane.rowIndex="7" GridPane.columnIndex="1" />
                                                <Label text="Trạng thái" GridPane.rowIndex="8" GridPane.columnIndex="0" />
                                                <ComboBox fx:id="statusCombo" prefWidth="200.0" GridPane.rowIndex="8" GridPane.columnIndex="1" />
                                                <Label text="Ghi chú" GridPane.rowIndex="9" GridPane.columnIndex="0" />
                                                <TextArea fx:id="noteArea" prefRowCount="3" GridPane.rowIndex="9" GridPane.columnIndex="1" />
                                            </children>
                                        </GridPane>
                                        <HBox alignment="CENTER_RIGHT" spacing="8.0" VBox.vgrow="ALWAYS">
                                            <children>
                                                <Button text="Lưu thay đổi" fx:id="saveBtn" onAction="#onSave" />
                                                <Button text="Hoàn tác" fx:id="revertBtn" onAction="#onRevert" />
                                                <Button text="Xóa hẹn" fx:id="deleteBtn" onAction="#onDelete" />
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>
                        <Tab text="Timeline">
                            <content>
                                <VBox spacing="8.0">
                                    <padding>
                                        <Insets bottom="12.0" left="12.0" right="12.0" top="12.0" />
                                    </padding>
                                    <children>
                                        <Label text="Diễn tiến" />
                                        <ListView fx:id="timelineList" VBox.vgrow="ALWAYS" />
                                        <HBox alignment="CENTER_RIGHT" spacing="8.0">
                                            <children>
                                                <Button text="Gửi SMS nhắc hẹn" fx:id="sendSmsBtn" onAction="#onSendSms" />
                                                <Button text="Gửi Email" fx:id="sendEmailBtn" onAction="#onSendEmail" />
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>
                        <Tab text="Ghi chú">
                            <content>
                                <VBox spacing="8.0">
                                    <padding>
                                        <Insets bottom="12.0" left="12.0" right="12.0" top="12.0" />
                                    </padding>
                                    <children>
                                        <TextArea fx:id="extraNoteArea" VBox.vgrow="ALWAYS" />
                                        <HBox alignment="CENTER_RIGHT" spacing="8.0">
                                            <children>
                                                <Button text="Lưu ghi chú" fx:id="saveNoteBtn" onAction="#onSaveNote" />
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>
                    </tabs>
                </TabPane>
            </items>
        </SplitPane>
    </center>
    <bottom>
        <HBox alignment="CENTER_LEFT" prefHeight="30.0" prefWidth="200.0" spacing="10.0" BorderPane.alignment="CENTER">
            <padding>
                <Insets bottom="6.0" left="8.0" right="8.0" top="6.0" />
            </padding>
            <children>
                <Label fx:id="lblSummary" text="Tổng: 0 hẹn | Hiển thị: 0" />
                <Region HBox.hgrow="ALWAYS" />
                <Button fx:id="firstPageBtn" text="⟪" onAction="#onFirstPage" />
                <Button fx:id="prevPageBtn" text="‹" onAction="#onPrevPage" />
                <Label fx:id="lblPage" text="Trang 1/1" />
                <Button fx:id="nextPageBtn" text="›" onAction="#onNextPage" />
                <Button fx:id="lastPageBtn" text="⟫" onAction="#onLastPage" />
            </children>
        </HBox>
    </bottom>
</BorderPane>